name: Daily Download
on:
  schedule:
    - cron: '0 3 * * *'
  workflow_dispatch:
jobs:
  gamedata:
    runs-on: ubuntu-latest
    env:
      TODAY: $(date --rfc-3339=date)
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: '15'
      - name: Test environment variables
        run: echo "${{ env.TODAY }}"
      - name: Install packages
        run: npm i
      - name: Run habbo-downloader
        run: node src/index.js -c gamedata -o resource/${{ env.TODAY }}
      - name: Git status
        run: git status
      - name: Push changes
        run: |
          git config user.name higoka
          git config user.email nico.rickenbach@gmail.com
          git add resource
          git commit -m "daily resources download"
          git push origin dev
